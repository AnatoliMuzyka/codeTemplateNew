<!DOCTYPE html>
<html>
  <head>
    <title>БСП доп.отчеты добавить новый</title>
  </head>
  <body>
	<h1>Модуль объекта отчета</h1>
    <p>
		<code>
			<pre>
Функция СведенияОВнешнейОбработке() Экспорт

	 ОбъектыНазначенияФормы = Новый Массив;
	 ОбъектыНазначенияФормы.Добавить("Документ.РеализацияТоваровУслуг");

	 ПараметрыРегистрации = ПолучитьПараметрыРегистрации(ОбъектыНазначенияФормы, "ТОРГ - 12 (альтернативная)");
	 ПараметрыРегистрации.Версия = "2017.03.07";
	 ПараметрыРегистрации.Информация = "Внешняя печатная форма документа реализации товаров и услуг ТОРГ - 12 (альтернативная)";

	 ТаблицаКоманд = ПолучитьТаблицуКоманд();

	 ДобавитьКоманду(ТаблицаКоманд,
	 "ТОРГ - 12 (альтернативная)",      // Представление команды в пользовательском интерфейсе
	 "ТОРГ_12_альтернативная",          // Уникальный идентификатор команды
	 "ВызовСерверногоМетода",           // Использование команды //ОткрытиеФормы
	 Истина,                            // Показывать оповещение.
	 "ПечатьMXL"                        // Дополнительный модификатор команды.);

	 ПараметрыРегистрации.Вставить("Команды", ТаблицаКоманд);

	 Возврат ПараметрыРегистрации;

КонецФункции

Функция ПолучитьПараметрыРегистрации(ОбъектыНазначенияФормы = Неопределено, НаименованиеОбработки = "", Информация = "", Версия = "1.0.0")

         Если ТипЗнч(ОбъектыНазначенияФормы) = Тип("Строка") Тогда
                  ОбъектНазначенияФормы = ОбъектыНазначенияФормы;
                  ОбъектыНазначенияФормы = Новый Массив;
                  ОбъектыНазначенияФормы.Добавить(ОбъектНазначенияФормы);
         КонецЕсли;

         ПараметрыРегистрации = Новый Структура;
         ПараметрыРегистрации.Вставить("Вид", "ПечатнаяФорма");
         ПараметрыРегистрации.Вставить("БезопасныйРежим", Истина);
         ПараметрыРегистрации.Вставить("Назначение", ОбъектыНазначенияФормы);

         Если Не ЗначениеЗаполнено(НаименованиеОбработки) Тогда
                  НаименованиеОбработки = ЭтотОбъект.Метаданные().Представление();
         КонецЕсли;

         ПараметрыРегистрации.Вставить("Наименование", НаименованиеОбработки);

         Если Не ЗначениеЗаполнено(Информация) Тогда
                  Информация = ЭтотОбъект.Метаданные().Комментарий;
         КонецЕсли;

         ПараметрыРегистрации.Вставить("Информация", Информация);
         ПараметрыРегистрации.Вставить("Версия", Версия);

         Возврат ПараметрыРегистрации;

КонецФункции
Функция ПолучитьТаблицуКоманд()

         Команды = Новый ТаблицаЗначений;
                  Команды.Колонки.Добавить("Представление", Новый ОписаниеТипов("Строка"));
                  Команды.Колонки.Добавить("Идентификатор", Новый ОписаниеТипов("Строка"));
                  Команды.Колонки.Добавить("Использование", Новый ОписаниеТипов("Строка"));
                  Команды.Колонки.Добавить("ПоказыватьОповещение", Новый ОписаниеТипов("Булево"));
                  Команды.Колонки.Добавить("Модификатор", Новый ОписаниеТипов("Строка"));

         Возврат Команды;

КонецФункции
Процедура ДобавитьКоманду(ТаблицаКоманд, Представление, Идентификатор, Использование, ПоказыватьОповещение = Ложь, Модификатор = "")

// Добавляем команду в таблицу команд по переданному описанию.
// Параметры и их значения можно посмотреть в функции ПолучитьТаблицуКоманд

         НоваяКоманда = ТаблицаКоманд.Добавить();
                  НоваяКоманда.Представление = Представление;
                  НоваяКоманда.Идентификатор = Идентификатор;
                  НоваяКоманда.Использование = Использование;
                  НоваяКоманда.ПоказыватьОповещение = ПоказыватьОповещение;
                  НоваяКоманда.Модификатор = Модификатор;

КонецПроцедуры
Функция Печать(СсылкаНаОбъект, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт // Запускается при печати

         КоллекцияПечатныхФорм = Новый ТаблицаЗначений;
                  КоллекцияПечатныхФорм.Колонки.Добавить("ИмяМакета");
                  КоллекцияПечатныхФорм.Колонки.Добавить("ИмяВРЕГ");
                  КоллекцияПечатныхФорм.Колонки.Добавить("СинонимМакета");
                  КоллекцияПечатныхФорм.Колонки.Добавить("ТабличныйДокумент");
                  КоллекцияПечатныхФорм.Колонки.Добавить("Экземпляров");
                  КоллекцияПечатныхФорм.Колонки.Добавить("Картинка");
                  КоллекцияПечатныхФорм.Колонки.Добавить("ПолныйПутьКМакету");

         Настройка=КоллекцияПечатныхФорм.Добавить();
                  Настройка.ИмяВРЕГ= "ТОРГ_12_АЛЬТЕРНАТИВНАЯ";
                  Настройка.Экземпляров = 1;

         Возврат УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
                  "ТОРГ_12_Альтернативная", "ТОРГ 12 (Альтернативная)",
                  ПолучитьТабличныйДокументТорг12(СсылкаНаОбъект, ОбъектыПечати)); // Функция «ПолучитьТабличныйДокументТорг12» вернет табличный документ для печати

КонецФункции
			</pre>
		</code>
	</p>
 </body>
</html>