<!DOCTYPE html>
<html>
  <head>
    <title>подключение команды печать</title>
  </head>
  <body>
  <h1>подключение команды печать</h1>
	<h2>модуль формы документа</h2>
    <p>
		<code>
			<pre>
	&НаСервере
	Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
		ПодключаемыеКоманды.ПриСозданииНаСервере(ЭтотОбъект);
	КонецПроцедуры
	&НаКлиенте 
	Процедура Подключаемый_ВыполнитьКоманду(Команда)
		ПодключаемыеКомандыКлиент.ВыполнитьКоманду(ЭтотОбъект, Команда, Объект);
		ЭтаФорма.Прочитать();
	КонецПроцедуры 

	&НаСервере
	Процедура Подключаемый_ВыполнитьКомандуНаСервере(Контекст, Результат)
		ПодключаемыеКоманды.ВыполнитьКоманду(ЭтотОбъект, Контекст, Объект, Результат);
	КонецПроцедуры 
	&НаКлиенте
	Процедура Подключаемый_ОбновитьКоманды()
		ПодключаемыеКомандыКлиентСервер.ОбновитьКоманды(ЭтотОбъект, Объект);
	КонецПроцедуры

	&НаСервере
	Процедура ПриЧтенииНаСервере(ТекущийОбъект)
		ПодключаемыеКомандыКлиентСервер.ОбновитьКоманды(ЭтотОбъект, Объект); 
	КонецПроцедуры
			</pre>
		</code>
	</p>
	<h2>модуль менеджера документа</h2>
	
	    <p>
		<code>
			<pre>
	// Заполняет список команд печати.
	// 
	// Параметры:
	//   КомандыПечати - ТаблицаЗначений - состав полей см. в функции УправлениеПечатью.СоздатьКоллекциюКомандПечати
	//
	Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
		КомандаПечати 				= КомандыПечати.Добавить();
		КомандаПечати.Идентификатор = "АктСписанияОбразца";
		КомандаПечати.Представление = НСтр("ru = 'Акт списания образцов'");
		КомандаПечати.Обработчик    = "УправлениеПечатьюБПКлиент.ВыполнитьКомандуПечати";
		КомандаПечати.СписокФорм    = "ФормаДокумента";
		КомандаПечати.Картинка 		= БиблиотекаКартинок.ФорматWord2007; // картинка на кнопку
		КомандаПечати.ПроверкаПроведенияПередПечатью = Истина;
		КомандаПечати.Порядок       = 10;
	КонецПроцедуры

			</pre>
		</code>
	</p>
	<h2>расширение - общие модули - УправлениеПечатьюПереопределяемый</h2>
	
	    <p>
		<code>
			<pre>
	Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
		ПечатнаяФорма = УправлениеПечатью.СведенияОПечатнойФорме(КоллекцияПечатныхФорм, "АктВозвратаОбразца");
		Если ПечатнаяФорма <> Неопределено Тогда
			ИмяМакета = "АКТ_НА_ВОЗВРА";
			МакетИДанныеОбъекта = УправлениеПечатьюВызовСервера.МакетыИДанныеОбъектовДляПечати("Документ.ЦИ_АктВозвратаОбразцов", ИмяМакета, МассивОбъектов);
		
	КонецПроцедуры

			</pre>
		</code>
	</p>
 </body>
</html>