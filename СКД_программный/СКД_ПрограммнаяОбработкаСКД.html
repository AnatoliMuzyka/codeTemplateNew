<!DOCTYPE html>
<html>
  <head>
    <title>Программная обработка результатов СКД</title>
  </head>
  <body>
	<h1>Программная обработка результатов СКД</h1>
    <p>
		<code>
			<pre>
			
Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
	ИтоговыеНастройки = КомпоновщикНастроек.ПолучитьНастройки();
	
	//Можем редактировать настройки компоновки (ИтоговыеНастройки)
	
	КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
	МакетКомпоновкиДанных = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, ИтоговыеНастройки, ДанныеРасшифровки);
	
	//Можем редактировать итоговые наборы данных и макеты табличного документа (МакетКомпоновкиДанных)
	
	ПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновки.Инициализировать(МакетКомпоновкиДанных, , ДанныеРасшифровки, истина);
	
	ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	ПроцессорВывода.УстановитьДокумент(ДокументРезультат);
	
	//Формируем отчет поэлементно
	//Вместо стандартного вывода одним методом - ПроцессорВывода.Вывести(ПроцессорКомпоновки)
	ПроцессорВывода.НачатьВывод();
	параметрыЯчейкиОсновногоПоступления = undefined;
	назвПарам_количествоОбразцов = "П22";// количествоОбразцов
	параметрыДляПроверкиНаСовпадение = новый массив;
	параметрыДляПроверкиНаСовпадение.Добавить("П1");
	параметрыДляПроверкиНаСовпадение.Добавить("П6");
	параметрыДляПроверкиНаСовпадение.Добавить("П7");
	параметрыДляПроверкиНаСовпадение.Добавить("П8");
	параметрыДляПроверкиНаСовпадение.Добавить("П9");
	параметрыДляПроверкиНаСовпадение.Добавить("П10");
	параметрыДляПроверкиНаСовпадение.Добавить("П12");
	параметрыДляПроверкиНаСовпадение.Добавить("П14");
	параметрыДляПроверкиНаСовпадение.Добавить("П16");
	параметрыДляПроверкиНаСовпадение.Добавить("П18");
	параметрыДляПроверкиНаСовпадение.Добавить("П20");
	Пока Истина Цикл
		ЭлементРезультата = ПроцессорКомпоновки.Следующий();
		Если ЭлементРезультата = Неопределено Тогда
			Прервать;
		КонецЕсли;
		
		//Можем редактировать данные, внешний вид и расшифровку выводимого элемента (ЭлементРезультата)
		Если ЭлементРезультата.ЗначенияПараметров.Количество() > 0 Тогда
			текущиеПараметры = ЭлементРезультата.ЗначенияПараметров;
			ТекстОбщегоКоличестваОбразцов = текущиеПараметры[назвПарам_количествоОбразцов].Значение;
			Если найти(ТекстОбщегоКоличестваОбразцов, "К =") > 0 Тогда
				параметрыЯчейкиОсновногоПоступления = текущиеПараметры; 
			КонецЕсли;
			Если найти(ТекстОбщегоКоличестваОбразцов, "У =") > 0 Тогда
				Для каждого параметрСовпадения Из параметрыДляПроверкиНаСовпадение Цикл
					Если текущиеПараметры[параметрСовпадения].Значение 
						= 
						параметрыЯчейкиОсновногоПоступления[параметрСовпадения].Значение Тогда
					
						ЭлементРезультата.ЗначенияПараметров[параметрСовпадения].Значение = "";// если значение такое как и в предидущей строке,
						                                                              // то вывести пустое значение
					
					КонецЕсли;				
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
		ПроцессорВывода.ВывестиЭлемент(ЭлементРезультата);
	КонецЦикла;
	ПроцессорВывода.ЗакончитьВывод();
	
	//Можем редактировать табличный документ (ДокументРезультат)
	
КонецПроцедуры

			</pre>
		</code>
	</p>
	<p>
	files\ЦИ_ЖурналРегистрацииДанныхОбОбразце_новый_23_12_22.erf 
	</p>
 </body>
</html>